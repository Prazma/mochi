<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>mochi</title>
  <link rel="stylesheet" href="./demo_files/style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body data-gr-c-s-loaded="true">
<div class="container">
<section>
    <button id="button" onclick="listen()">Start Request</button>
    <button id="stop">Force Stop</button>
    <div id="output"></div>
</section>
<script src="https://raw.githubusercontent.com/Prazma/mochi/master/js/mochi.speech.js"></script>
<!-- window.fetch pollyfill for IE/Edge & Older Chrome/FireFox -->
<script src="https://raw.githubusercontent.com/Prazma/mochi/master/js/fetch.js"></script>
<script>
function listen() {
  fetch('https://raw.githubusercontent.com/Prazma/mochi/master/token')
  .then(function(response) {
      return response.text();
  }).then(function (token) {
    var stream = WatsonSpeech.SpeechToText.recognizeMicrophone({
        token: token,
        outputElement: '#output' // CSS selector or DOM Element
    });
    stream.on('error', function(err) {
        console.log(err);
    });
    document.querySelector('#stop').onclick = function() {
      stream.stop();
    };
  }).catch(function(error) {
      console.log(error);
  });
};
</script>
</div>
</body></html>
